IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
GO

BEGIN TRANSACTION;
GO

CREATE TABLE [CATEGORIAS] (
    [CAT_CODIGO] int NOT NULL IDENTITY,
    [CAT_NOMBRE] nvarchar(max) NOT NULL,
    [CAT_FECHACREACION] datetime2 NOT NULL,
    [CAT_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_CATEGORIAS] PRIMARY KEY ([CAT_CODIGO])
);
GO

CREATE TABLE [CLIENTES] (
    [CLI_ID] int NOT NULL IDENTITY,
    [CLI_NOMBRE] nvarchar(max) NOT NULL,
    [CLI_TIPOCLIENTE] nvarchar(max) NOT NULL,
    [CLI_UBICACION] nvarchar(max) NOT NULL,
    [CLI_DIRECCION] nvarchar(max) NOT NULL,
    [CLI_FECHACREACION] datetime2 NOT NULL,
    [CLI_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_CLIENTES] PRIMARY KEY ([CLI_ID])
);
GO

CREATE TABLE [MARCAS] (
    [MAR_CODIGO] int NOT NULL IDENTITY,
    [MAR_NOMBRE] nvarchar(max) NOT NULL,
    [MAR_FECHACREACION] datetime2 NOT NULL,
    [MAR_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_MARCAS] PRIMARY KEY ([MAR_CODIGO])
);
GO

CREATE TABLE [MOTIVOSGASTOS] (
    [MOG_CODIGO] int NOT NULL IDENTITY,
    [MOG_NOMBRE] nvarchar(max) NOT NULL,
    [MOG_FECHACREACION] datetime2 NOT NULL,
    [MOG_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_MOTIVOSGASTOS] PRIMARY KEY ([MOG_CODIGO])
);
GO

CREATE TABLE [TIPOSCUENTAS] (
    [TIC_CODIGO] int NOT NULL IDENTITY,
    [TIC_NOMBRE] nvarchar(max) NOT NULL,
    [TIC_NUMEROREFERENCIA] int NOT NULL,
    [TIC_FECHACREACION] datetime2 NOT NULL,
    [TIC_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_TIPOSCUENTAS] PRIMARY KEY ([TIC_CODIGO])
);
GO

CREATE TABLE [USUARIOS] (
    [USU_CEDULA] int NOT NULL IDENTITY,
    [USU_NOMBRE] nvarchar(max) NOT NULL,
    [USU_CONTRASEÑA] nvarchar(max) NOT NULL,
    [USU_ROL] nvarchar(max) NOT NULL,
    [USU_FECHACREACION] datetime2 NOT NULL,
    [USU_FECHAACTUALIZACION] datetime2 NOT NULL,
    [USU_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_USUARIOS] PRIMARY KEY ([USU_CEDULA])
);
GO

CREATE TABLE [PRODUCTOS] (
    [PRO_CODIGO] nvarchar(450) NOT NULL,
    [PRO_NOMBRE] nvarchar(max) NOT NULL,
    [MAR_CODIGO] int NOT NULL,
    [CAT_CODIGO] int NOT NULL,
    [PRO_PRECIO_COMPRA] real NOT NULL,
    [PRO_PRECIOVENTA_DETAL] real NOT NULL,
    [PRO_PRECIOVENTA_MAYORISTA] real NOT NULL,
    [PRO_UNIDADES_DISPONIBLES] int NOT NULL,
    [PRO_UNIDADES_MINIMAS_ALERTA] int NOT NULL,
    [PRO_ACTUALIZACION] datetime2 NOT NULL,
    [PRO_FECHACREACION] datetime2 NOT NULL,
    [PRO_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_PRODUCTOS] PRIMARY KEY ([PRO_CODIGO]),
    CONSTRAINT [FK_PRODUCTOS_CATEGORIAS_CAT_CODIGO] FOREIGN KEY ([CAT_CODIGO]) REFERENCES [CATEGORIAS] ([CAT_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_PRODUCTOS_MARCAS_MAR_CODIGO] FOREIGN KEY ([MAR_CODIGO]) REFERENCES [MARCAS] ([MAR_CODIGO]) ON DELETE CASCADE
);
GO

CREATE TABLE [COMPRAS] (
    [COM_CODIGO] int NOT NULL IDENTITY,
    [COM_FECHACREACION] datetime2 NOT NULL,
    [COM_FECHACOMPRA] datetime2 NOT NULL,
    [COM_VALORCOMPRA] real NOT NULL,
    [COM_PROVEEDOR] nvarchar(max) NOT NULL,
    [TIC_CODIGO] int NOT NULL,
    [COM_FECHAACTUALIZACION] datetime2 NOT NULL,
    [COM_ENBODEGA] bit NOT NULL,
    [COM_ESTADO] bit NOT NULL,
    [COM_CREDITO] bit NOT NULL,
    [USU_CEDULA] int NOT NULL,
    CONSTRAINT [PK_COMPRAS] PRIMARY KEY ([COM_CODIGO]),
    CONSTRAINT [FK_COMPRAS_TIPOSCUENTAS_TIC_CODIGO] FOREIGN KEY ([TIC_CODIGO]) REFERENCES [TIPOSCUENTAS] ([TIC_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_COMPRAS_USUARIOS_USU_CEDULA] FOREIGN KEY ([USU_CEDULA]) REFERENCES [USUARIOS] ([USU_CEDULA]) ON DELETE CASCADE
);
GO

CREATE TABLE [VENTAS] (
    [VEN_CODIGO] int NOT NULL IDENTITY,
    [VEN_FECHACREACION] datetime2 NOT NULL,
    [VEN_FECHAVENTA] datetime2 NOT NULL,
    [VEN_TIPOPAGO] nvarchar(max) NOT NULL,
    [TIC_CODIGO] int NOT NULL,
    [CLI_ID] int NOT NULL,
    [VEN_PRECIOTOTAL] real NOT NULL,
    [VEN_ESTADOCREDITO] bit NULL,
    [VEN_ENVIO] bit NULL,
    [VEN_DOMICILIO] bit NULL,
    [VEN_OBSERVACIONES] nvarchar(max) NOT NULL,
    [VEN_ACTUALIZACION] datetime2 NULL,
    [USU_CEDULA] int NOT NULL,
    [VEN_ESTADOVENTA] bit NOT NULL,
    [VEN_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_VENTAS] PRIMARY KEY ([VEN_CODIGO]),
    CONSTRAINT [FK_VENTAS_CLIENTES_CLI_ID] FOREIGN KEY ([CLI_ID]) REFERENCES [CLIENTES] ([CLI_ID]) ON DELETE CASCADE,
    CONSTRAINT [FK_VENTAS_TIPOSCUENTAS_TIC_CODIGO] FOREIGN KEY ([TIC_CODIGO]) REFERENCES [TIPOSCUENTAS] ([TIC_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_VENTAS_USUARIOS_USU_CEDULA] FOREIGN KEY ([USU_CEDULA]) REFERENCES [USUARIOS] ([USU_CEDULA]) ON DELETE CASCADE
);
GO

CREATE TABLE [DETALLECOMPRAS] (
    [DEC_CODIGO] int NOT NULL IDENTITY,
    [COM_CODIGO] int NOT NULL,
    [PRO_CODIGO] nvarchar(450) NOT NULL,
    [DEC_UNIDADES] int NOT NULL,
    [DEC_PRECIOCOMPRA_PRODUCTO] real NOT NULL,
    [DEC_PRECIOTOTAL] real NOT NULL,
    [DEC_FECHACREACION] datetime2 NOT NULL,
    [DEC_FECHAACTUALIZACION] datetime2 NOT NULL,
    [DEC_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_DETALLECOMPRAS] PRIMARY KEY ([DEC_CODIGO]),
    CONSTRAINT [FK_DETALLECOMPRAS_COMPRAS_COM_CODIGO] FOREIGN KEY ([COM_CODIGO]) REFERENCES [COMPRAS] ([COM_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_DETALLECOMPRAS_PRODUCTOS_PRO_CODIGO] FOREIGN KEY ([PRO_CODIGO]) REFERENCES [PRODUCTOS] ([PRO_CODIGO]) ON DELETE CASCADE
);
GO

CREATE TABLE [CARTERAS] (
    [CAR_CODIGO] int NOT NULL IDENTITY,
    [CAR_FECHACREACION] datetime2 NOT NULL,
    [CAR_FECHACREDITO] datetime2 NOT NULL,
    [CAR_FECHAACTUALIZACION] datetime2 NOT NULL,
    [CAR_MOTIVO] nvarchar(max) NOT NULL,
    [VEN_CODIGO] int NOT NULL,
    [CAR_VALORCREDITO] real NOT NULL,
    [CAR_VALORABONADO] real NOT NULL,
    [CAR_ESTADOCREDITO] int NOT NULL,
    [CAR_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_CARTERAS] PRIMARY KEY ([CAR_CODIGO]),
    CONSTRAINT [FK_CARTERAS_VENTAS_VEN_CODIGO] FOREIGN KEY ([VEN_CODIGO]) REFERENCES [VENTAS] ([VEN_CODIGO]) ON DELETE CASCADE
);
GO

CREATE TABLE [DETALLEVENTAS] (
    [VED_CODIGO] int NOT NULL IDENTITY,
    [VEN_CODIGO] int NOT NULL,
    [PRO_CODIGO] nvarchar(450) NOT NULL,
    [VED_UNIDADES] int NOT NULL,
    [VED_PRECIOVENTA_UND] real NOT NULL,
    [VED_VALORDESCUENTO_UND] real NOT NULL,
    [VED_PRECIOVENTA_TOTAL] real NOT NULL,
    [VED_ACTUALIZACION] datetime2 NOT NULL,
    [VED_ESTADO] bit NOT NULL,
    CONSTRAINT [PK_DETALLEVENTAS] PRIMARY KEY ([VED_CODIGO]),
    CONSTRAINT [FK_DETALLEVENTAS_PRODUCTOS_PRO_CODIGO] FOREIGN KEY ([PRO_CODIGO]) REFERENCES [PRODUCTOS] ([PRO_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_DETALLEVENTAS_VENTAS_VEN_CODIGO] FOREIGN KEY ([VEN_CODIGO]) REFERENCES [VENTAS] ([VEN_CODIGO]) ON DELETE CASCADE
);
GO

CREATE TABLE [GASTOS] (
    [GAS_CODIGO] int NOT NULL IDENTITY,
    [GAS_FECHACREACION] datetime2 NOT NULL,
    [GAS_FECHAGASTO] datetime2 NOT NULL,
    [MOG_CODIGO] int NOT NULL,
    [GAS_VALOR] real NOT NULL,
    [TIC_CODIGO] int NOT NULL,
    [GAS_ESTADO] bit NOT NULL,
    [USU_CEDULA] int NOT NULL,
    [GAS_PENDIENTE] bit NOT NULL,
    [VEN_CODIGO] int NULL,
    CONSTRAINT [PK_GASTOS] PRIMARY KEY ([GAS_CODIGO]),
    CONSTRAINT [FK_GASTOS_MOTIVOSGASTOS_MOG_CODIGO] FOREIGN KEY ([MOG_CODIGO]) REFERENCES [MOTIVOSGASTOS] ([MOG_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_GASTOS_TIPOSCUENTAS_TIC_CODIGO] FOREIGN KEY ([TIC_CODIGO]) REFERENCES [TIPOSCUENTAS] ([TIC_CODIGO]) ON DELETE CASCADE,
    CONSTRAINT [FK_GASTOS_USUARIOS_USU_CEDULA] FOREIGN KEY ([USU_CEDULA]) REFERENCES [USUARIOS] ([USU_CEDULA]) ON DELETE CASCADE,
    CONSTRAINT [FK_GASTOS_VENTAS_VEN_CODIGO] FOREIGN KEY ([VEN_CODIGO]) REFERENCES [VENTAS] ([VEN_CODIGO])
);
GO

CREATE INDEX [IX_CARTERAS_VEN_CODIGO] ON [CARTERAS] ([VEN_CODIGO]);
GO

CREATE INDEX [IX_COMPRAS_TIC_CODIGO] ON [COMPRAS] ([TIC_CODIGO]);
GO

CREATE INDEX [IX_COMPRAS_USU_CEDULA] ON [COMPRAS] ([USU_CEDULA]);
GO

CREATE INDEX [IX_DETALLECOMPRAS_COM_CODIGO] ON [DETALLECOMPRAS] ([COM_CODIGO]);
GO

CREATE INDEX [IX_DETALLECOMPRAS_PRO_CODIGO] ON [DETALLECOMPRAS] ([PRO_CODIGO]);
GO

CREATE INDEX [IX_DETALLEVENTAS_PRO_CODIGO] ON [DETALLEVENTAS] ([PRO_CODIGO]);
GO

CREATE INDEX [IX_DETALLEVENTAS_VEN_CODIGO] ON [DETALLEVENTAS] ([VEN_CODIGO]);
GO

CREATE INDEX [IX_GASTOS_MOG_CODIGO] ON [GASTOS] ([MOG_CODIGO]);
GO

CREATE INDEX [IX_GASTOS_TIC_CODIGO] ON [GASTOS] ([TIC_CODIGO]);
GO

CREATE INDEX [IX_GASTOS_USU_CEDULA] ON [GASTOS] ([USU_CEDULA]);
GO

CREATE INDEX [IX_GASTOS_VEN_CODIGO] ON [GASTOS] ([VEN_CODIGO]);
GO

CREATE INDEX [IX_PRODUCTOS_CAT_CODIGO] ON [PRODUCTOS] ([CAT_CODIGO]);
GO

CREATE INDEX [IX_PRODUCTOS_MAR_CODIGO] ON [PRODUCTOS] ([MAR_CODIGO]);
GO

CREATE INDEX [IX_VENTAS_CLI_ID] ON [VENTAS] ([CLI_ID]);
GO

CREATE INDEX [IX_VENTAS_TIC_CODIGO] ON [VENTAS] ([TIC_CODIGO]);
GO

CREATE INDEX [IX_VENTAS_USU_CEDULA] ON [VENTAS] ([USU_CEDULA]);
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20230910162804_dbinit', N'7.0.10');
GO

COMMIT;
GO

